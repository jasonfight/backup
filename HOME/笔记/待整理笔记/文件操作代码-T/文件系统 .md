## Python 文件系统

### 定义

文件是计算机中非常重要的东西，在Python中将文件是做一种类型的对象，文件包括普通的文本，图片，音频，视频等，在Linux系统中有"一切皆对象"的说法,所以文件对象不仅可以用来访问普通的磁盘文件,而且可以访问任何其他类型抽象层面上的文件.

### 文件类型

在linux中,文件类型共有七种:

1. 块设备文件
1. 字符设备文件
1. 目录
1. 普通文件
1. 链接文件
1. 套接字文件
1. 管道文件

## 打开和关闭文件

```python
file_obj=open(file_name,access_mode,buffering=-1)
功能:打开一个文件,返回一个文件流对象
参数:  file_name:文件名
      access_mode:打开文件的方式,如果不写,默认为'r'
      buffering:参数0表示无缓冲,1表示有行缓冲,如果大于1,则数字为缓冲区的大小,如果不写或者为负数,则为使用系统默认值
```
文件模式|操作
----|----
r|以**读**的方式打开,文件必须存在
w|以**写**的方式打开,文件**不存在则创建**
a|以**追加**的方式打开
r+|以**读写**的模式打开,文件必须存在
w+|以**读写**的模式打开,文件**不存在则创建**,清空原有内存
a+|以**读写**模式打开,是**追加**模式.
rb|以**二进制读**模式打开 同r
wb|以**二进制写**模式打开 同w
ab|以**二进制追加**模式打开 同a
rb+|以**二进制读写**模式打开 同r+
wb+|以**二进制读写**模式打开 同w+
ab+|以**二进制读写**模式打开 同a+

### 流(stream)

所有的I/O操作仅仅是简单的从程序移进或者移出,这种字节流,就成为流.

系统已经默认为我们打开了三个流,在sys模块中:

```
标准输入:sys.stdin
标准输出:sys.stdout
标准错误:sys.stderr
```
### 缓冲

系统自动的在内存中为每一个正在使用的文件开辟一个缓冲区,从内存磁盘输出数据必须先送到内存缓冲区,装满缓冲区之后再一起送到磁盘中去,从磁盘中读取数据,则将文件中的一批数据督导缓冲区中,然后从缓冲区逐个的将数据送到程序的数据区.

```py
f = open(file_name,'r+')
f.__doc__
f.close()
```
打开一个文件后,就可以通过文件流对文件进行操作了,当操作结束后使用close()关闭这个流.可以防止一些误操作并节省资源,此外,可以通过下面的方式,不用close
```py
with open('file_name','r+')
  f.__doc__
```
with语句生成的对象在语句块结束之后会自动处理,所以不需要close,但这个流只能在with语句内使用.

### 读取文件

```py
read([size])
readline([size])
readlines([size])
```
read([size]) 方法用来直接读取字节到字符串中,最对读取size个字节,如果没有给定size(默认为-1)或者size为负数,文件将被读到末尾,文件过大时,建议在nonblocking模式下使用

readline([size]) 方法读取打开文件中的一行(下个行结束符之前的所有字节),房后将包括行结束符号的内容作为字符串返回,size的使用方法和read()中的一致.

readlines([sizhint]) 方法不会返回字符串,对读取剩余的行,然后返回一个**字符串列表**,它的可选参数sizhint代表返回的最大字节大小。如果它大于 0，那么返回的所有行应该大约有sizhint字节（可能稍微大于这个数字，因为需要凑齐缓冲区大小）。

### 写入文件

```py
write(string)
writelines(str_list)
```
write(string) 功能与read() readline()相反,是将内容写到文件中去

weitelines(str_list) 与readlines()一样,针对列表的操作,接受一个字符串列表,写入文件,行结束符不会被自动加入,所以需要的话,必须在每行结尾加上行结束符

###  缓冲区刷新

flush()函数用于手动刷新缓冲区

### 文件位置偏移

打开一个文件时,系统会生成一个记录,记录中描述对文件的一系列操作,其中包括每次操作到的文件位置.

seek()方法可以在文件中移动文件指针到不同的位置,

```py
seek(offset[,whence])
#offset: 相对与某个位置的偏移量,可以为负数,表示向前移动
#whence:基准位置,默认为0,表示文件开头,1代表当前位置,2代表文件末尾.
```
### 文件内容迭代

在python中,不需要调用read()方法,就可以在for循环中迭代文件中的每一行,可以使用迭代器的next方法,file.next()可以用来读取文件的下一行,和其他迭代器一样,python也会在所有航迭代完成后引发StopIteration异常.

```py
f = open('file_name')
for line in f:
  print line
  print '2222222'
f.next()#有问题,需要再整理
```
### 查看文件信息

```py
import os
file_stat = os.stat('file_name')
file_stat
>>> os.stat_result(st_mode=33204, st_ino=135235, st_dev=2053, st_nlink=1,
  st_uid=1000, st_gid=1000, st_size=12, st_atime=1464256496, st_mtime=1464256509, st_ctime=1464256
```
